In this starting challenge, we are given the learning objectives of leaning the basics of Linux CLI, exploring its uses in personal objectives and IT administration, as well as unveiling the mystery of the challenge! We are given a VM to start, and when complete, we are greeted with a Linux terminal, `mcskidy@tbfc-web01`.

# Working with the Linux CLI

We are introduced to many basic Linux CLI commands, such as `ls, pwd, echo, cat`, etc. With these, we can check our current user's home directory and we find a README.txt.

Using the `cat` command, we can read some lore that points us to the `Guides/` directory. Once we navigate inside, there is a hidden file named `.guide.txt`. We can open it with the line `cat .guide.txt`.  This file gives us a flag along with the following hint:

```
Check /var/log/ and grep inside, let the logs become your guide.
Look for eggs that want to hide, check their shells for what's inside!
```

Naturally, we will cd to `/var/log` and check what we can find! The walkthrough points us to grep the `auth.log` file for "Failed password". This yields several failed password attempts for the "socmas" account. Assuming that an eventual login was complete, we can change to that user's home directory to check for anything scandalous via `cd /home/socmas`. 

We are also told that our bunny antagonist does not work with exploits, but eggsploits. We can search the socmas home directory for anything containing the phrase "egg" with the following line: `find -name *egg*`, where the asterisks represent wildcard characters. We have found `/home/socmas/2025/eggstrike.sh`.

After outputting the contents of this exploit, we are given a flag along with the following:

```
cat wishlist.txt | sort | uniq > /tmp/dump.txt
rm wishlist.txt && echo "Chistmas is fading..."
mv eastmas.txt wishlist.txt && echo "EASTMAS is invading!"
```

Reading through these commands, we can get an idea of what the attacker has done:
1. We grab the unique entries in wishlist.txt and move it to /tmp/dump.txt
2. We delete wishlist.txt and echo "Christmas is fading..." to the terminal
3. We move the contents of eastmas.txt into wishlist.txt and echo again.

The walkthrough prompts us to visit localhost at port 8080. Here, we can see that our Christmas list has been eccentrically Easter themed. Trouble is brewing.

This essentially concludes the normal portion of day 1 of AoC. However, towards the end of the walkthrough, we are told that an intermediate challenge is located within `/home/mcskidy/Documents/`. Let's `cd` there and check it out.

```
From: mcskidy
To: whoever finds this

I had a short second when no one was watching. I used it.

I've managed to plant a few clues around the account.
If you can get into the user below and look carefully,
those three little "easter eggs" will combine into a passcode
that unlocks a further message that I encrypted in the
/home/eddi_knapp/Documents/ directory.
I didn't want the wrong eyes to see it.

Access the user account:
username: eddi_knapp
password: S0mething1Sc0ming

There are three hidden easter eggs.
They combine to form the passcode to open my encrypted vault.

Clues (one for each egg):

1)
I ride with your session, not with your chest of files.
Open the little bag your shell carries when you arrive.

2)
The tree shows today; the rings remember yesterday.
Read the ledger’s older pages.

3)
When pixels sleep, their tails sometimes whisper plain words.
Listen to the tail.

Find the fragments, join them in order, and use the resulting passcode
to decrypt the message I left. Be careful — I had to be quick,
and I left only enough to get help.

~ McSkidy
```

So, in the new users `Documents/` directory, there is an encrypted file. We must solve three riddles to piece the decryption key together and grab the secret key. Let's begin by logging in:

`su eddi_knapp`

We are prompted for a password, then given access to the account. Inside `Documents/`, we can see the `.gpg` file, which by the extension, has been encrypted.

# Challenge 1

```
I ride with your session, not with your chest of files.
Open the little bag your shell carries when you arrive.
```

Open the bag your shell carries when you arrive. The shell is another word for a terminal interface in Linux devices. The common shell is bash (I have used zsh in the past). 

In the home directory, we can look through the files that are of the form `.bash*`. Notably, `.bashrc` most likely contains the information it is specifically talking about. At the end of the file, we can see an environment variable being exported:

```
export PASSFRAG1="3ast3r"
```

# Challenge 2

```
The tree shows today; the rings remember yesterday.
Read the ledger ’s older pages.
```

I did several things starting this portion of the challenge. First, I checked for `.bash_history`, which did not exist. Next, I tried using `journalctl` and quickly parsing some of the `auth.log` or  `syslog` stuff. However, I should have known that the password was closer to the actual user itself.

If we use `ls -a` on the new user's home directory, we can see several hidden files. Among them is `.secret_git`. If we navigate to this directory, we can check what git actions  have been done using `git log`. Here, we can see that McSkidy has removed a note and added a separate one. We can view the individual commits using `git show <commit-id>`. Doing this rewards us with the second portion of the key:

```
+PASSFRAG2: -1s-
```

# Challenge 3

```
When pixels sleep, their tails sometimes whisper plain words.
Listen to the tail.
```

We have several hints here. Pixels points us to pictures, and  `tail` is a command that retrieves the end of a file. We can change into the `Pictures/` directory and begin to analyze.

Once inside, we can run `ls -a` to see many files that are suspicious: hidden_pic, .easter_egg, etc

But wait... `.easter_egg` is not a picture! We can verify by running `file .easter_egg`. This tells us that it is indeed ASCII text. We can either output the entire file, or just use `tail`. Regardless, we get the last bit of our key:

```
~~ HAPPY EASTER ~~~
PASSFRAG3: c0M1nG
```

Now, with all three fragments, we combine to create one password:

```
3ast3r-1s-c0M1nG
```

# Conclusion

Inside of the `Documents/` directory, we can decrypt the file with this line: `echo "3ast3r-1s-c0M1nG" | gpg --batch --yes --passphrase-fd 0 mcskidy_note.txt.gpg`.

This gives us the following plaintext:

```
Congrats — you found all fragments and reached this file.

Below is the list that should be live on the site. If you replace the contents of
/home/socmas/2025/wishlist.txt with this exact list (one item per line, no numbering),
the site will recognise it and the takeover glitching will stop. Do it — it will save the site.

Hardware security keys (YubiKey or similar)
Commercial password manager subscriptions (team seats)
Endpoint detection & response (EDR) licenses
Secure remote access appliances (jump boxes)
Cloud workload scanning credits (container/image scanning)
Threat intelligence feed subscription

Secure code review / SAST tool access
Dedicated secure test lab VM pool
Incident response runbook templates and playbooks
Electronic safe drive with encrypted backups

A final note — I don't know exactly where they have me, but there are *lots* of eggs
and I can smell chocolate in the air. Something big is coming.  — McSkidy

---

When the wishlist is corrected, the site will show a block of ciphertext. This ciphertext can be decrypted with the following unlock key:

UNLOCK_KEY: 91J6X7R4FQ9TQPM9JX2Q9X2Z

To decode the ciphertext, use OpenSSL. For instance, if you copied the ciphertext into a file /tmp/website_output.txt you could decode using the following command:

cat > /tmp/website_output.txt
openssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 -in /tmp/website_output.txt -out /tmp/decoded_message.txt -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'
cat /tmp/decoded_message.txt

Sorry to be so convoluted, I couldn't risk making this easy while King Malhare watches. — McSkidy
```

Following the above leads us to this output:

```
Well done — the glitch is fixed. Amazing job going the extra mile and saving the site. Take this flag THM{w3lcome_2_A0c_2025}

NEXT STEP:
If you fancy something a little...spicier....use the FLAG you just obtained as the passphrase to unlock:
/home/eddi_knapp/.secret/dir

That hidden directory has been archived and encrypted with the FLAG.
Inside it you'll find the sidequest key.
```

Again, following this output gives us the following file:

![[Pasted image 20251201143031.png]]