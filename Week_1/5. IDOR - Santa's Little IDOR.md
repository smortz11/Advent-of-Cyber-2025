IDOR (insecure direct object reference) is a vulnerability primarily found in web applications that allows users to manipulate values found in the URL to access portions of a site that should not be accessible. The learning objectives of the day include spotting IDOR, exploiting it to perform horizontal privilege escalation, and how to convert these vulnerabilities into secure direct object references (SDOR). Let's get into it. We start by initializing the attackbox and VM.

Take for example the following link:

```
`https://awesome.website.thm/TrackPackage?packageID=1001`
```

What would happen if we changed the value `1001` to another one? This is a potential case for IDOR. How can this be done securely? Consider the situation where package ID's are sequential. It becomes trivial to guess the other possible ID's. We would gather information from a database via (example):

```
`SELECT person, address, status FROM Packages WHERE packageID = value;`
```

The IDOR vulnerability surfaces when we do not verify that the person making the request is the same one who own the package. This process of verification is often done with the use of cookies or tokens containing session information. Subsequent requests to the server will include this token. The token can expire, which is why people are redirected to login pages after long periods of time.

The first example asks us to login to a web app in the VM. From here, using developer tools, we can see a variable `user_id` stored locally with a value of 10. Changing this to an 11 and refreshing the page shows us a dashboard for a new user. This is the simplest type of IDOR. The next type of IDOR rests behind a request being made upon the click of a button. This retrieves data for a "child", which we can see a base64 encoded request for in the network tab. The same can also be done if a button generates a hash. If we can identify the hash, we can replicate data to cram into the cookies in order to abuse IDOR.

Flipping perspective, the best way to stop IDOR is to authenticate and authorize. The system *must* confirm that the logged-in user is authorized to see or change the requested information. That being said, though, variables such as IDs should not be sequential. They should be random. That alone is not enough, however. When we combine random IDs with authentication and authorization, however, we can create safer web apps. 

The first two questions of the room are mentioned in descriptions above. The third question, however, requires us to brute force the `user_id` variable. It does not need to be done too much in order to solve the problem, though.