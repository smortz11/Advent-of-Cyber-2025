Welcome to day nine of TryHackMe's Advent of Cyber. The objectives for today include how password-based encryption protects files, what makes a weak password, dictionary and brute-force attacks on passwords, and actual password cracking. In today's age, a longer password is more secure than a shorter random one, both for memory and strength reasons. Let's go ahead and start our VM and start the day!

With modern cryptography, attackers are not very likely to crack the encryption itself. Instead, attackers crack the password used to encrypt files, which can be done in multiple ways. Dictionary attacks include the use of a predefined list of passwords, like a wordlist. Brute force attacks go a step further and try every combination of letters until it finds the right one. This, while more computationally difficult, guarantees success (eventually, that is). We can also use mask attacks, which defines a password format that may be followed to greatly reduce the number of brute force attempts we will be making.

A common workflow for cracking a password would be similar to this:
- Try a wordlist like rockyou.txt or common-passwords.txt
- Try a targeted wordlist, like company names, project names, or data from a breach
- Try a mask or incremental attack on short paswords
- Use GPU-accelerated when possible
- Keep an eye on resource use. It is very CPU/GPU heavy to creack passwords! This can be detected on an endpoint

In this challenge, we are given a password protected zip file as well as a password protected pdf file. There are different workflows we can use to crack each. Let's start with the pdf file:

With a pdf, we can use a command like:
`pdfcrack -f flag.pdf -w /usr/share/wordlists/rockyou.txt`
where the argument following `-f` is our file to crack and the argument following `-w` is our wordlist. This quickly solves the password.

With a zip, we can use a command like:
`zip2john flag.zip > ziphash.txt`
`john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt`
The first command looks at the zip file and creates a hash of the password in a way that john can understand, which we then crack with the following command. After grabbing the password, we can extract the zip and enter our password, decrypting the files within.

On the blue team side of things, it could be important to look at different indicators and telemetry of password cracking. There are a slew of buzzwords that could suggest hash cracking (john, hashcat, fcrackzip, pdfcrack, ...). Knowing these tool names allows us to take preventative measures of them being run or working on our endpoints. This could be done with Sysmon in Windows, audit rules in Linux, or various process monitors present on both operating systems.
### Q1: What is the flag inside the encrypted PDF?
Use pdfcrack or pdf2john to crack the password (specific commands are mentioned above)

### Q2: What is the flag inside the encrypted zip file?
Use zip2john to create a hash that john can understand and crack it with john! Specific commands are mentioned above.